# alfaCJ2025 Команда Фраед ребс
Задание и материалы: https://disk.yandex.ru/d/1l5Xe4DgxprbGA
### Решение
В тренировочный и тестовый датасеты были добавлены переменные, такие как:
* Численная нумерация месяца, вместо строки 'month_x'
* Стартовый кластер в предыдущем месяце
* Значение колонок в прошлом месяце (только для 'cols_for_lags')
* Разница между значениями колонок в текущем и прошлом месяце (только для 'cols_for_lags')

В колонки для лагов 'cols_for_lags' были включены:
1. **balance_amt_avg** - 	Среднемесячный остаток на счетах клиента за месяц
2. **balance_amt_max** - Максимальный остаток на счетах клиента за месяц
3. **balance_amt_min** - Минимальный остаток на счетах клиента за месяц
4. **balance_amt_day_avg** - Среднедневной остаток на счетах клиента за месяц
5. **ft_registration_date** - Количество дней с даты регистрации в ФНС
6. **max_founderpres** - Количество дней, прошедших с первой даты регистрации огрн
7. **min_founderpres** - Количество дней, прошедших с последней даты регистрации огрн
8. **ogrn_exist_months** - Количество полных месяцев, прошедших с момента получения ОГРН

Пропуски стартого кластера в шестом месяце у было решено заполнением его тем же кластером, что и в пятом месяце. Этот метод показал себя как наиболее эффективный, но были испробованы другие варианты заполнения, например использование модели LightGBM для предсказания стартого кластера.

### Обучение
Для обучения была выбрана библиотека LightGBM в силу её скорости, были испробованы библиотеки CatBoost и XGBoost, но для завершения их обучения требовалось сильно больше времени.

Сначала предсказания создавались с помощью time-based валидации, но с целью улучшения точности и уменьшения влияния случайных факторов, была примененна кросс валидация k-fold. Часть параметров модели была взята как общепринятые значения, часть была подобрана чтобы давать наилучший результат. Optuna была использована, но в силу временнЫх ограничений и времязатратности подбора параметров, результат с ней был получен хуже, поэтому были оставлены старые параметры

### Получение результата
Для того, чтобы получить результат предсказания, основанном но обученой модели, необходимо:
1. Загрузить скрипт ACJ_ML_Script.py
2. В ту же директорие, где и находится скрипт, загрузить:
   * test_data.pqt
   * train_data.pqt
   * cluster_weights.xlsx
   * sample_submission.csv
3. Запустить скрипт
